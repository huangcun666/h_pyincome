<!DOCTYPE HTML>
<html>

<head>
    <title>{{template_row.site_title}}</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="/static/theme/h78/css/style.css" rel="stylesheet" type="text/css" media="all" />
    <link rel="stylesheet" type="text/css" href="/static/theme/h78/css/prettyPhoto.css">

    <!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
    <link rel="stylesheet" href="/static/jqup/jquery.fileupload.css">

    <link rel="stylesheet" href="/static/js/dist/jquery.contextMenu.min.css">
    <link href="/static/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
     <link href="/static/js/css/froala_editor.pkgd.min.css" rel="stylesheet" type="text/css" />
    <link href="/static/js/css/froala_style.min.css" rel="stylesheet" type="text/css" />

    <link rel="stylesheet" type="text/css" href="/static/theme/h78/css/magnific-popup.css">



    <style>
    .tag {
        font-size: 14px;
        font-family: 'Droid Serif';
        text-align: center;
        color: #FFF;
        margin-left: 15px;
        padding: 6px;
        background-color: red;
        float: right;
        z-index: 100000;
        display: block;
        position: fixed;

    }

    #tag {
    position: fixed;
    top: 1em;
    right: 1em;
}

.white-popup {
    background: #fff none repeat scroll 0 0;
    margin: 60px auto;
    max-width: 650px;
    padding: 20px 30px;
    position: relative;
    text-align: center;
}
    </style>

</head>

<body>
           <div class="tag rightmenu">配置</div>
    <div class="header fy_bg_img" style="background:url({img_backgroundimage});-moz-background-size:40% 100%;background-size:100% 100%; background-repeat:no-repeat;" id="img_backgroundimage">

        <header id="home">
            <div class="bg_mask">
                <div class="wrap clearfix ">
                    <div class="logo1"><img class="rightmenu_img "  id="img_top_logo"  src="{img_top_logo}" alt="title" title="mod_1" /></div>
                    <h1 > <div class="text_editor" title="mod_2">{mod_2}</div></h1>
                    <p class="text_editor" title="mod_3">{mod_3}</p>
                    <h6> </h6>
                    <a href="#about" class="button scroll "><img src="/static/theme/h78/images/down.png" alt="了解更多关于我们"></a>
                    <div class="clear"> </div>
                </div>
            </div>
        </header>
    </div>
    <nav class="nav_wrapper">

        <div class="wrap">
            <div class="logo"><img class="rightmenu_img" id="img_logo" src="/static/theme/h78/images/logo1.png" alt="logo" /></div>
            <a href="#" class="header_toggle">Menu</a>

            <ul class="navigation" id="fy_navigation">

                    {fy_navigation}

            </ul>

            <div class="clear"> </div>
        </div>
    </nav>
    <!------nav_js scripts---->
    <script src="/static/js/jquery.min.1.3.js"></script>
    <script type="text/javascript" src="/static/theme/h78/js/modernizr.js"></script>
    <script type="text/javascript" src="/static/theme/h78/js/jquery.stellar.min.js"></script>
    <script type="text/javascript" src="/static/theme/h78/js/jquery.singlePageNav.js"></script>
    <script type="text/javascript" src="/static/theme/h78/js/jquery.sticky.js"></script>
    <script type="text/javascript" src="/static/theme/h78/js/scripts.js"></script>
    <!-----end nav js------>
    <!-----start-about------>
    <div class="about" id="about">
        <div class="wrap">
            <div class="text_editor" title="tag_about_h2"><h2>{tag_about_h2}</h2></div>
            <div class="text_editor" title="tag_about_h4"> <h4>{tag_about_h4}</h4></div>
            <h6> </h6>
            <div class="text_editor" title="tag_about_desc"><p class="para_a">{tag_about_desc}</p></div>
            <!---strat-top-grids---->
            <div class="top-grids">
                <div class="top-grid">
                    <a class="icon monitor" href="#"> </a>
                     <div class="text_editor" title="tag_about_6"><a href="#">{tag_about_6}</a></div>
                     <div class="text_editor" title="tag_about_7"><p>{tag_about_7}</p></div>
                </div>
                <div class="top-grid">
                    <a class="icon target" href="#"> </a>
                    <div class="text_editor" title="tag_about_8"><a href="#">{tag_about_8}</a></div><div class="text_editor" title="tag_about_9">
                    <p>{tag_about_9}</p></div>
                </div>
                <div class="top-grid">
                    <a class="icon event" href="#"> </a>
                   <div class="text_editor" title="tag_about_10"> <a href="#">{tag_about_10}</a></div>
                   <div class="text_editor" title="tag_about_11">
                <p>{tag_about_11}</p>
                </div>
                </div>
                <div class="clear"> </div>
            </div>
            <!---End-top-grids---->
        </div>
        <div class="grids-of_4">
            <div class="wrap">
                <div class="grid_of_1">
                    <a class=" icon cup" href="#"> </a>
                    <div class="sub_grid">
                       <div class="text_editor" title="tag_total_1">  <span>{tag_total_1}</span></div>
                        <div class="text_editor" title="tag_total_2"> <p>{tag_total_2}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid_of_1">
                    <a class=" icon smill" href="#"> </a>
                    <div class="sub_grid">
                       <div class="text_editor" title="tag_total_3"> <span>{tag_total_3}</span></div>
                        <div class="text_editor" title="tag_total_4">  <p>{tag_total_4}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid_of_1">
                    <a class=" icon meeting" href="#"> </a>
                    <div class="sub_grid">
                         <div class="text_editor" title="tag_total_5"><span>{tag_total_5}</span></div>
                       <div class="text_editor" title="tag_total_6">  <p>{tag_total_6}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid_of_1">
                    <a class=" icon parties" href="#"> </a>
                    <div class="sub_grid">
                       <div class="text_editor" title="tag_total_7">  <span>{tag_total_7}</span></div>
                       <div class="text_editor" title="tag_total_8">  <p>{tag_total_8}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="clear"> </div>
            </div>
        </div>
        <div class="clients">
            <div class="bg_mask1">
                <div class="wrap">
                      <div class="text_editor" title="tag_clients_1"><h3>{tag_clients_1}</h3></div>
                     <div class="text_editor" title="tag_clients_2"><h4>{tag_clients_2}</h4></div>
                    <h6> </h6>
                    <div class="clients_img">
                        <ul id="flexiselDemo3">
                            <li><img src="/static/theme/h78/images/client1.png" /></li>
                            <li><img src="/static/theme/h78/images/client2.png" /></li>
                            <li><img src="/static/theme/h78/images/client3.png" /></li>
                            <li><img src="/static/theme/h78/images/client4.png" /></li>
                            <li><img src="/static/theme/h78/images/client1.png" /></li>
                            <li><img src="/static/theme/h78/images/client2.png" /></li>
                            <li><img src="/static/theme/h78/images/client3.png" /></li>
                        </ul>
                        <script type="text/javascript" src="/static/theme/h78/js/jquery.flexisel.js"></script>
                        <script type="text/javascript">
                        $(window).load(function() {
                            $("#flexiselDemo3").flexisel({
                                visibleItems: 5,
                                animationSpeed: 1000,
                                autoPlay: true,
                                autoPlaySpeed: 3000,
                                pauseOnHover: true,
                                enableResponsiveBreakpoints: true,
                                responsiveBreakpoints: {

                                    portrait: {
                                        changePoint: 480,
                                        visibleItems: 1
                                    },
                                    landscape: {
                                        changePoint: 640,
                                        visibleItems: 2
                                    },
                                    tablet: {
                                        changePoint: 768,
                                        visibleItems: 3
                                    }
                                }
                            });

                        });
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-----end-about--------->
    <!----start-team-------->
    <div class="services" id="services">
        <div class="text_editor" title="tag_service_1"><h3 class="heading">{tag_service_1}</h3></div>
        <div class="text_editor" title="tag_service_2"><p class="desc">{tag_service_2}</p></div>
        <h6> </h6>
        <div class="wrap">
            <div class="service_grids">
                <div class="grid1">
                    <a class="icon system" href="#"> </a>
                    <div class="grid_sub">
                        <div class="text_editor" title="tag_service_3"><h3>{tag_service_3}</h3></div>
                        <h6> </h6>
                        <div class="text_editor" title="tag_service_4"> <p>{tag_service_4}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid1">
                    <a class="icon tools" href="#"> </a>
                    <div class="grid_sub">
                        <div class="text_editor" title="tag_service_5"> <h3>{tag_service_5}</h3></div>
                        <h6> </h6>
                        <div class="text_editor" title="tag_service_6">  <p>{tag_service_6}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid1">
                    <a class="icon mobile" href="#"> </a>
                    <div class="grid_sub">
                       <div class="text_editor" title="tag_service_7"> <h3>{tag_service_7}</h3></div>
                        <h6> </h6>
                       <div class="text_editor" title="tag_service_8"> <p>{tag_service_8}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid1">
                    <a class="icon monitor" href="#"> </a>
                    <div class="grid_sub">
                       <div class="text_editor" title="tag_service_9"> <h3>{tag_service_9}</h3></div>
                        <h6> </h6>
                       <div class="text_editor" title="tag_service_10"> <p>{tag_service_10}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid1">
                    <a class="icon smonitor" href="#"> </a>
                    <div class="grid_sub">
                        <div class="text_editor" title="tag_service_11"> <h3>{tag_service_11}</h3></div>
                        <h6> </h6>
                        <div class="text_editor" title="tag_service_12"> <p>{tag_service_12}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="grid1">
                    <a class="icon radio" href="#"> </a>
                    <div class="grid_sub">
                       <div class="text_editor" title="tag_service_13">  <h3>{tag_service_13}</h3></div>
                        <h6> </h6>
                       <div class="text_editor" title="tag_service_14">  <p>{tag_service_14}</p></div>
                    </div>
                    <div class="clear"> </div>
                </div>
                <div class="clear"> </div>
            </div>
        </div>
        <div class="slider2">
            <div class=" bg_mask1 bg_mask2">
                <div class="wrap">
                    <div class="text_editor" title="tag_smask_1"> <p><img src="/static/theme/h78/images/lg.png">{tag_smask_1} <img src="/static/theme/h78/images/lg.png"> </p></div>
                    <h6> </h6>
                   <div class="text_editor" title="tag_smask_2">  <h4>{tag_smask_2}</h4></div>
                </div>
            </div>
        </div>
    </div>


    <div class="team" id="team">
         <div class="text_editor" title="tag_team_1"><h3 class="heading"> {tag_team_1}</h3></div>
         <div class="text_editor" title="tag_team_2"><p class="desc">{tag_team_2}</p></div>
        <h6> </h6>

    </div>

      {fy_team_members}

    <!-- Owl Carousel Assets -->
    <link href="/static/theme/h78/css/owl.carousel.css" rel="stylesheet">
    <!-- Owl Carousel Assets -->
    <!-- Prettify -->
    <script src="/static/theme/h78/js/owl.carousel.js"></script>
    <script>
    $(document).ready(function() {

        $("#owl-demo").owlCarousel({
            items: 3,
            lazyLoad: true,
            autoPlay: true,
            navigation: true,
            navigationText: ["", ""],
            rewindNav: false,
            scrollPerPage: false,
            pagination: true,
            paginationNumbers: false,
        });

    });
    </script>
    <!-- //Owl Carousel Assets -->


            </div>
            <!--end:typo1-->
        </div>

    <div class="contact" id="contact">
        <p><br/>
       <div class="text_editor" title="tag_contact_title"> <h3 class="heading">{tag_contact_title}</h3></div>
        <div class="text_editor" title="tag_contact_context"><p class="desc">{tag_contact_context}</p></div>
        <h6> </h6>
    </p>
        <div class="contact-bg">
            <div class="tool_tip">
                <a href="#"><img src="/static/images/logo1.png"/></a>
            </div>
            <div class="wrap">
                <div class="form">
                    <div class="contact-form">
                            <div>
                              <span><label>姓名</label></span>
                                <span><input id="name" name="name" type="text" class="textbox"></span>
                            </div>
                            <div>
                                <span><label>邮箱/电话</label></span>
                                <span><input id="email" name="email" type="text" class="textbox"></span>
                            </div>
                            <div>
                                <span><label>内容</label></span>
                                <span><textarea id="msg" name="msg"> </textarea></span>
                            </div>
                            <div>
                                <span><input type="button" id="btn_save_msg" value="提交"></span>
                            </div>
                    </div>
                    <div class="address">
                        <div class="text_editor" title="tag_contact_info1"><h3 class="heading">{tag_contact_info1}</h3></div>
                       <div class="text_editor" title="tag_contact_info2"> <p>{tag_contact_info2}</p></div>
                      <!--   <div class="c_grids text_editor" title="tag_contact_info3">
                            <a class=" icon contact-img" href="#"> </a>
                            <p>拨打400-800-2345</p>
                            <p>我们将竭诚为您服务。</p>
                            <div class="clear"> </div>
                        </div> -->
             <!--            <div class="c_grids text_editor" title="tag_contact_info5">
                            <a class=" icon website" href="#"> </a>
                            <p>发邮件联系我们</p>
                            <p>我们将在48小时内回复。
</p>
                            <div class="clear"> </div>
                        </div> -->
                    </div>
                    <div class="clear"> </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div class="wrap">
            <div class="footer-left">
                <div class="copy text_editor" title="tag_footer">
                    <p>{tag_footer}</p>
                </div>
            </div>

            <div class="clear"> </div>
        </div>
   <div id="changebackground_mfp" class="mfp-hide">
        <div class="pop_up">
            <div class="member-content clearfix">
                <div class="flx-skill-widget widget">
                    <p>
                        <h3 class="widget-title">更换多媒体文件<span></span></h3>
                        <div class="flx-skill clearfix">
    <span class="btn btn-success fileinput-button">
        <i class="glyphicon glyphicon-plus"></i>
        <span>点击选择本地文件...</span>
        <input id="fileupload" type="file" name="files_my[]" data-url="/upload_img" >
    </span>
    <br>
    <br>
    <div id="progress" class="progress">
        <div class="progress-bar progress-bar-success"></div>
    </div>
    <div id="files" class="files"></div>
    <br> </div>
                    </p>
                </div>
                <div class="flx-skill clearfix">
                </div>
                <div class="clear"> </div>
            </div>
        </div>
    </div>

        <div id="change_menu" class="mfp-hide white-popup">
            <div class="pop_up">
                <div class="member-content clearfix">
                    <div class="flx-skill-widget widget">

           菜单配置 <input type="button" id="btn_save_menu" value="保 存"/>


        <hr/>
            <table class="table" style="width: 80%">
                <thead>
                <tr>
                    <td>栏目名</td>
                    <td>连接</td>

                </tr>
                </thead>
                <tbody id="tb_menu">

                </tbody>
            </table>


                    </div>
                    <div class="flx-skill clearfix">
                    </div>
                    <div class="clear"> </div>
                </div>
            </div>
        </div>

   <div id="change_team" class="mfp-hide white-popup">
            <div class="pop_up">
                <div class="member-content clearfix">

           <h3 class="widget-title">团队管理 <input type="button" id="btn_save_team" value="保 存"/>
 <input type="button" id="btn_add_team" value="新增"/>
           </h3>
             <div class="flx-skill clearfix">


            <table class="table" style="width: 100%">
                <thead>
                <tr>
                    <td>名称</td>
                    <td>部门或描述</td>
                     <td>相片</td>
                </tr>
                </thead>
                <tbody id="tb_team">

                </tbody>
            </table>


                    </div>
                    <div class="flx-skill clearfix">
                    </div>
                    <div class="clear"> </div>
                </div>
            </div>
        </div>

        <input type="hidden" value="" id="fileupload_type"/>
        <script type="text/javascript" src="/static/theme/h78/js/move-top.js"></script>
        <script type="text/javascript" src="/static/theme/h78/js/easing.js"></script>
        <script type="text/javascript">
        $(document).ready(function() {
            var defaults = {
                containerID: 'toTop', // fading element id
                containerHoverID: 'toTopHover', // fading element hover id
                scrollSpeed: 1200,
                easingType: 'linear'
            };
            $().UItoTop({ easingType: 'easeOutQuart' });
        });
        </script>
        <script type="text/javascript">
        jQuery(document).ready(function($) {
            $(".scroll").click(function(event) {
                event.preventDefault();
                $('html,body').animate({ scrollTop: $(this.hash).offset().top }, 1200);
            });
        });
        </script>

        <script>
        function getCookie(name) {
            var r = document.cookie.match("\\b" + name + "=([^;]*)\\b");
            return r ? r[1] : undefined;
        }

         function delete_team_member(i){
                $("#member_id_"+i).remove()
                // $(".owl-wrapper .owl-item").eq(i).remove()

         }
        $(function() {
            $("#btn_save_team").on("click",function(){
                $(".owl-wrapper").html("")
                str = ""
                $("table #tb_team tr").each(function(i,obj){
                    name = $(this).find("input[name=member_name]").val()
                    txt_department =$(this).find("input[name=txt_department]").val()
                    txt_img = $(this).find("input[name=txt_img]").val()
                    str += '<div class="owl-item"><div class="item"><div class="carousel"><a class="popup-with-zoom-anim" href="#small-dialog1"><img style="width: 509px;"  src="'+txt_img+'" alt=""/></a><div class="caption-info"><div class="caption-info-head"><div class="caption-info-head-left "><h4><a href="javascript:void(0)"   class="team_memeber_name">'+name+'</a></h4><span class="team_department">'+txt_department+'</span></div><div class="caption-info-head-right"><ul><a href="#"><span></span></a></li><div class="clear"></div></ul></div><div class="clear"></div></div></div></div></div></div>'
                    console.log(name+"_____"+txt_department+"____"+txt_img)
                })
                //   console.log(str)
                $(".owl-wrapper").html(str)

            })


            $("#btn_save_msg").on("click",function(){
                name = $("#name").val()
                email = $("#email").val()
                msg=$("#msg").val()

                $.post("/guestbook",{"name":name,"email":email,"msg":msg,"_xsrf":getCookie("_xsrf"),"site_id":{{template_row.id}}},function(result){
                        if(result=="1"){
                            alert("提交成功, 稍候我们会与您联系!")
                        }
                })
            })


            $("#btn_save_menu").on("click",function(){
                $(".navigation").html("")
                 jsonObj = [];
                 $('input[name=txt_menu_name]').each(function(i, obj) {
                    txt_name = $(this).val()
                    txt_link = $("input[name=txt_menu_link]").eq(i).val()

                      item = {}
                      item ["txt_name"] = txt_name;
                      item ["txt_link"] = txt_link;

                      jsonObj.push(item);
                      $(".navigation").append('<li class="scroll"><a href="'+txt_link+'">'+txt_name+'</a></li>')
                  });
                 console.log(jsonObj);
                 // $('.txt_name').each(function(i, obj) {

                 //    txt_name = $(this).val()
                 //    txt_link = $(".txt_link").eq(i).val()

                 //    console.log(txt_link)
                 //    $(".navigation").append('<li class="scroll"><a href="'+txt_link+'">'+txt_name+'</a></li>')
                 //  });

                 $.magnificPopup.close()

                $.post("/edittemplate",{"key_name":"fy_navigation","key_value": JSON.stringify(jsonObj),"_xsrf":getCookie("_xsrf"),"site_id":{{template_row.id}}},function(result){
                    // alert(result)
                    console.log(result)
                })
            })


           $('#fileupload').fileupload({
                autoUpload: true,
                formData: {_xsrf: getCookie("_xsrf"),"fileupload_type":$("#fileupload_type").val()},
                type:"post",
                done: function (e, data) {
                    // alert(data.result)
                    $.magnificPopup.close()
                    // $.each(data.result.files, function (index, file) {
                    //     $('<p/>').text(file.name).appendTo(document.body);
                    // });
                    // alert(data)
                    fileupload_id = $("#fileupload_type").val()
                    console.log(fileupload_id)
                    if(fileupload_id=="img_backgroundimage"){
                      $("#"+fileupload_id).css('background-image', 'url("'+data.result+'")');

                    }else
                    {
                        // alert($("#"+fileupload_id).attr("src"))
                         $("#"+fileupload_id).attr("src",""+data.result+"");
                    }
               $.post("/edittemplate",{"key_name":"fy_navigation","key_value": $("#fy_navigation").html(),"_xsrf":getCookie("_xsrf"),"site_id":{{template_row.id}}},function(result){
                    // alert(result)
                    console.log(result)
                })


                $.post("/edittemplate",{"key_name":fileupload_id,"key_value":data.result,"_xsrf":getCookie("_xsrf"),"site_id":{{template_row.id}}},function(result){
                    // alert(result)
                    console.log(result)
                })
                },
                fail: function(e, data) {
                  alert('Fail!');
                }

            });


            $(".text_editor").froalaEditor({

                language: 'zh_cn',
                toolbarInline: true,
                charCounterCount: false,
                initOnClick: true,
                toolbarButtons: ['Bord', 'italic', 'underline', 'strikeThrough', 'color', 'emoticons', '-', 'paragraphFormat', 'align', 'formatOL', 'formatUL', 'indent', 'outdent', '-', 'insertImage', 'insertLink', 'insertFile', 'insertVideo', 'undo', 'redo']
            })


            $('.text_editor').on('froalaEditor.blur', function (e, editor) {
              // Do something here.
                _xsrf = getCookie("_xsrf");
                key_name =  $(this).attr("title")
                key_value = $(this).text()
                $.post("/edittemplate",{"key_name":key_name,"key_value":key_value,"_xsrf":_xsrf,"site_id":{{template_row.id}}},function(result){
                    // alert(result)
                    console.log(result)
                })
            });

            $.contextMenu({
                selector: '.rightmenu_menu',
                trigger: 'left',
                callback: function(key, options) {
                    id = options.$trigger.attr("id");
                    $('[data-fancybox]').fancybox({
                        protect: true
                    });

                    var m = "clicked: " + key;
                    window.console && console.log(m) || alert(m);
                },
                items: {
                    "edit": { name: "修改logo", icon: "edit" },
                    "cut": { name: "修改菜单", icon: "cut" },
                    "copy": { name: "修改社交工具", icon: "copy" },
                    "sep1": "---------",
                    "quit": {
                        name: "Quit",
                        icon: function() {
                            return 'context-menu-icon context-menu-icon-quit';
                        }
                    }
                }
            });

            $.contextMenu({
                selector: '.rightmenu_img',
                trigger: 'left',
                callback: function(key, options) {
                    if(key=="m_img_top_logo"){

                        id_name = $(this).attr("id")
                        $("#fileupload_type").val(id_name)

                        // alert($("#fileupload_type").val())
                        $.magnificPopup.open({
                            items: {
                                src: '#changebackground_mfp'
                            },
                            type: 'inline'
                        }, 0);
                    }
                },
                items: {
                    "m_img_top_logo": { name: "更换图片", icon: "edit" },
                    "sep1": "---------",
                    "quit": {
                        name: "Quit",
                        icon: function() {
                            return 'context-menu-icon context-menu-icon-quit';
                        }
                    }
                }
            });

            $.contextMenu({
                trigger: 'left',
                selector: '.rightmenu',
                callback: function(key, options) {
                    id = options.$trigger.attr("id");
                    console.log(options)
                    console.log(key)
                    var m = "clicked: " + key + $() + id;
                    window.console && console.log(m);
                   if(key=="set_default"){
                        _xsrf = getCookie("_xsrf");
                        $('.text_editor').each(function(i, obj) {
                               key_name =  $(this).attr("title")
                                key_value = $(this).text()
                                $.post("/set_temp_key",{
                                    "key_name":key_name,
                                    "key_value":key_value,
                                     "_xsrf":_xsrf,
                                     "temp_id":{{template_row.temp_id}}},
                                function(result){
                                   console.log(result)
                                })
                         });
                        $('.rightmenu_img').each(function(i, obj) {
                               key_name =  $(this).attr("id")
                                key_value = $(this).attr("src")
                                $.post("/set_temp_key",{
                                    "key_name":key_name,
                                    "key_value":key_value,
                                     "_xsrf":_xsrf,
                                     "temp_id":{{template_row.temp_id}}},
                                function(result){
                                   console.log(result)
                                })
                         });
                        $('.fy_bg_img').each(function(i, obj) {
                               key_name =  $(this).attr("id")
                               img =$(this).css("background-image")
                               var reg = /.+?\:\/\/.+?(\/.+?)(?:#|\?|$)/;
                               var url_full_img =img.replace(/(url\(|\)|")/g, '');
                               var key_value = reg.exec(url_full_img)[1];

                                $.post("/set_temp_key",{
                                    "key_name":key_name,
                                    "key_value":key_value,
                                     "_xsrf":_xsrf,
                                     "temp_id":{{template_row.temp_id}}},
                                function(result){
                                   console.log(result)
                                })
                         });


                   }else if (key == "changebackground") {
                        $("#fileupload_type").val("img_backgroundimage")
                        // alert($("#fileupload_type").val())
                        $.magnificPopup.open({
                            items: {
                                src: '#changebackground_mfp'
                            },
                            type: 'inline'
                            }, 0);
                    }else if(key=="change_menu"){
                         $("#tb_menu").html("")
                          $(".navigation li").each(function(i,obj){
                            title = $(this).children("a").text()
                            link = $(this).children("a").attr("href")
                            str = '<tr><td><input type="input" id="txt_name_'+i+'" value="'+title+'" name="txt_menu_name"/></td> <td><input type="input" value="'+link+'" name="txt_menu_link" id="txt_link_'+i+'"/></td> <td></tr>'

                            $("#tb_menu").append(str)
                                 console.log($(this).children("a").attr("href"))
                             })

                          $("#tb_menu").append('<div class="clear"> </div>')
                          $.magnificPopup.open({
                            items: {
                                src: '#change_menu'
                            },
                            type: 'inline'
                        }, 0);
                    }else if(key=="change_team"){
                         // <div class="owl-item" style="width: 322px;"><div class="item"><div class="carousel"><a class="popup-with-zoom-anim" href="#small-dialog1"><img  src="/static/theme/h78/images/5.jpg" alt="Image 1"></a><div class="caption-info"><div class="caption-info-head"><div class="caption-info-head-left"><h4><a href="#" class="team_memeber_name">Hong Kong &amp; Macau</a></h4><span class="team_department">Bonus Extras!</span></div><div class="caption-info-head-right"><ul><div class="clear"></div></ul></div><div class="clear"></div></div></div></div></div></div>

                        $("#tb_team").html("")
                        $(".owl-wrapper .owl-item").each(function(i,obj){
                                team_memeber_name=  $(this).find(".team_memeber_name").text()
                                team_department =$(this).find(".team_department").text()
                                img = $(this).find("img").attr("src")
                                // console.log(team_department+team_memeber_name+img)
                                str = '<tr id="member_id_'+i+'"><td><input type="input" name="member_name" id="team_memeber_name_'+i+'" value="'+team_memeber_name+'" class="txt_name"/></td> <td><input type="input" value="'+team_department+'" class="txt_link" id="txt_department_'+i+'" name="txt_department"/></td><td><input type="button" class="del_member" value="换" onclick="delete_team_member('+i+')"/><input type="input" value="'+img+'" class="txt_link" name="txt_img" id="txt_img_'+i+'"/><input type="button" class="del_member" value="删" onclick="delete_team_member('+i+')"/></td> </tr>'
                                $("#tb_team").append(str)
                         })


                          $.magnificPopup.open({
                            items: {
                                src: '#change_team'
                            },
                            type: 'inline'
                        }, 0);


                    }
                    else if (key== "save_page"){
                       _xsrf = getCookie("_xsrf");
                        $('.text_editor').each(function(i, obj) {
                                key_name =  $(this).attr("title")
                                key_value = $(this).text()
                                $.post("/edittemplate",{
                                    "key_name":key_name,
                                    "key_value":key_value,
                                     "_xsrf":_xsrf,
                                     "site_id":{{template_row.id}}},
                                function(result){
                                   console.log(result)
                                })
                         });
                    }
                },
                items: {
                    "changebackground": { name: "修改背景", icon: "edit" },
                    "sep1": "---------",
                    "change_menu": { name: "菜单配置", icon: "edit" },
                    "change_team": { name: "团队配置", icon: "edit" },


                    "save_page": { name: "发布", icon: "save" },
                    "sep1": "---------"

                }
            });
        $("#btn_add_team").on("click",function(){
            i = $("input[name=member_name]").size()

            str = '<tr id="member_id_'+i+'"><td><input type="input" name="member_name" id="team_memeber_name_'+i+'" value="名字" class="txt_name"/></td> <td><input type="input" value="部门或描述" class="txt_link" name="txt_department" id="txt_department_'+i+'"/></td><td><input type="button" class="del_member" value="换" onclick="delete_team_member('+i+')"/><input type="input" value="/static/images/sf.jpg" class="txt_link" name="txt_img" id="txt_img_'+i+'"/><input type="button" class="del_member" value="删" onclick="delete_team_member('+i+')"/></td> </tr>'
            $("#tb_team").append(str)

        })

        })
        </script>
        <a href="#" id="toTop" style="display: block;"><span id="toTopHover" style="opacity: 1;"></span></a>
    </div>

<script src="/static/theme/h78/js/jquery.magnific-popup.js" type="text/javascript"></script>
<script src="/static/jqup/vendor/jquery.ui.widget.js"></script>
<script src="/static/jqup/jquery.iframe-transport.js"></script>
<script src="/static/jqup/jquery.fileupload.js"></script>
<script src="/static/js/dist/jquery.contextmenu.js"></script>
<script type="text/javascript" src="/static/js/froala_editor.pkgd.min.js"></script>
</body>
</html>